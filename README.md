# Node_Detect
本程序是一个基于计算机视觉的电气拓扑结构自动提取工具，旨在从 PDF 格式的电气原理图中解析设备节点与连接关系。程序核心逻辑首先通过 pdf2image 库将 PDF 转换为图像数据，接着利用 HSV 颜色空间进行多通道掩码提取，分别定位红色、黄色、黑色矩形节点以及连接圆点。针对复杂的绿色开关节点，程序采用了一套自适应形态学算法：首先通过“闭运算”修复由文字遮挡造成的像素空洞，再通过“开运算”切断其与绿色导线的物理连接，最后辅以严格的面积、实心度和长宽比几何筛选机制，从而精准识别出完整的开关块。在完成节点定位后，程序会对非节点区域进行骨架化处理，利用霍夫变换提取线路轨迹，并通过并查集算法（Union-Find）和中心辐射优先策略构建节点间的物理连接关系，最终将识别结果输出为可视化的连线标注图（JPG）和包含结构化数据的 CSV 文件。

运行本程序需要预先安装 OpenCV、NumPy、Pillow 和 pdf2image 等 Python 库。特别需要注意的是，pdf2image 依赖于外部工具 Poppler 来处理 PDF 文件，因此您需要在本地环境中下载并配置 Poppler 的二进制包。在运行代码之前，请务必在代码底部的 if __name__ == "__main__": 代码块中修改以下三个关键配置路径：首先将 my_pdf 变量修改为您实际需要处理的 PDF 文件的绝对路径；其次将 my_poppler 变量修改为您本地解压后的 Poppler 工具包中 bin 文件夹的绝对路径（该目录下应包含 pdfinfo.exe）；最后，如果您的 PDF 文件设置了打开密码，请在 my_password 变量中填入密码，若无密码则保持为空字符串或 None。
Poppler下载地址：https://github.com/oschwartz10612/poppler-windows/releases
